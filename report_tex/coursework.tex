\documentclass[a4paper,14pt]{extarticle}
\usepackage{geometry}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{fancyhdr}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{tikz}
\usepackage{pgf}
\usepackage{subcaption}
\usepackage{listings}
\usepackage[colorlinks, linkcolor=blue, urlcolor=blue]{hyperref}
\usepackage{indentfirst}
\graphicspath{{images/}}%путь к рисункам

\makeatletter
\renewcommand{\@biblabel}[1]{#1.} % Заменяем библиографию с квадратных скобок на точку:
\makeatother

\geometry{left=2.5cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=1.5cm}% верхнее поле
\geometry{bottom=1.5cm}% нижнее поле
\renewcommand{\baselinestretch}{1.5} % междустрочный интервал

\newcommand{\bibref}[3]{\hyperlink{#1}{#2 (#3)}} % biblabel, authors, year

\renewcommand{\theenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumii}{.\arabic{enumii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumiii}{.\arabic{enumiii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.}% Меняем везде перечисления на цифра.цифра


\begin{document}
    \input{title.tex}
    \newpage

    {
        \hypersetup{linkcolor=black}
        \tableofcontents
    }

    \newpage

    \begin{abstract}
        Автоматическое предсказание пола и возраста человека по фотографиям, полученным в самых разных условиях -
        это важная и сложная задача, находящая применение во многих областях жизнедеятельности людей.
        В своем проекте мы стремились воплотить подход к решению этой задачи, основанный на сверточных нейронных сетях.
        Свое решение мы разбили на две составных части - детектирование лица человека и ключевых точек на его лице
        и дальнейшее предсказание пола и возраста по признакам лица.
        \par Для детектирования мы используем архитектуру RetinaFace с предобученным на ImageNet-1000 ResNet-18 в качестве основой модели.
        В качестве обучающих данных мы используем датасет WIDER FACE с добавленными к нему пятью ключевыми точками для каждого лица.
        На тестовой выборке наш детектор получает значение метрики Precision равное 83\%.
        \par Для классификации найденных лиц мы используем модель на основе двух предобученных на ImageNet-1000 ResNet-18.
        В качестве обучающих данных мы испольуем датасеты IMDB-WIKI-101 и FGNET\@.
        В качестве тестовых данных мы используем датасет Adience, наша модель получает для возраста значение метрики
        Exact-accuracy 45\% и значение метрики One-off-accuracy 80\%, для пола значение метрики Accuracy 85\%.
        \par В итоге мы получили рабочую модель, способную обрабатывать большие массивы фотографий,
        детектировать на них людей и предсказывать для их пол и возраст в автоматическом режиме.
        Ссылка на гитхаб с проектом - \url{https://github.com/birshert/age_gender_classification}.
        \\
        \\
        \small \textbf{\textit{Ключевые слова---}}Определение возраста и пола, Детектирование лиц, Компьютерное зрение, Глубокое обучение \\
        Automatically predicting real age and gender from face images acquired in unconstrained conditions
        is an important and challenging task in many real-world applications.
        In our project we intended to construct an approach to predicting a person's real age and gender from photograph
        based on convolutional neural networks.
        Our solution is divided into solving two separate subtasks - detecting one's face and it's landmarks and
        further age and gender estimation based on facial features.
        \par For face detection we use RetinaFace architecture with a pretrained on ImageNet-1000 ResNet-18 as a backbone.
        For training we use WIDER FACE dataset with added five facial landmarks for every face.
        On testing subset we achieve 83\% Precision result.
        \par For real age and gender estimation we use a model based on two pretrained on ImageNet-1000 ResNet-18.
        For training we use IMDB-WIKI-101 dataset and FGNET dataset.
        For testing we use Adience dataset, our model achieves Exact-accuracy 45\%, One-off-accuracy 80\% for age estimation
        and 85\% Accuracy for gender prediction.
        \par As a result, we got a working model capable of processing large volumes of photos, detecting people faces on them and predicting their real age and gender in automatic mode.
        Github project link - \url{https://github.com/birshert/age_gender_classification}.
        \\
        \small \textbf{\textit{Keywords---}}Age and gender estimation, Facial detection, Computer vision, Deep learning
        \\
        \newpage
    \end{abstract}


    \section{Введение}\label{sec:введение}
    Во многих сферах деятельности требуется получать информацию о статистике про людей, проживающих на некоторой территории или пользующихся каким-либо продуктом.
    Хорошим источником такой информации являются фотографии людей, запечатлённых в определенных местах.
    Однако ручная обработка десятков тысяч фотографий в попытке получить нужные данные крайне сложна и время- и трудозатратна,
    поэтому большинство современных решений являют собой автоматическую обработку массивов фотографий,
    классифицируя людей на фотографиях по полу и возрасту с помощью методов компьютерного зрения.
    \par За время исследования проблемы классификации людей по фотографиям стало ясно, что использование алгоритмов,
    опирающихся на фиксированные выделенные людьми признаки, не приносит удовлетворительных результатов.
    Так происходит потому, что люди на фотографиях, запечатленные в неформальных условиях,
    имеют множество разных поз, форм и вариаций поворотов относительно камеры, которые не поддаются ручному анализу.
    \par Все известные подходы к классификации возрастных групп людей по фотографии заключаются в анализе изображения лица.
    Самые ранние~\cite{age1994} основывались на различиях в пропорциях и размерах черт лица в зависимости от возраста -
    так называемые антропометрические модели~\cite{unfiltered}.
    Все они вычисляли координаты точек на лице и в дальнейшем их анализировали.
    Более поздние и более современные методы~\cite{hassner,INDIA} опирались на использование сверточных нейронных сетей небольшой глубины.
    Самые современные подходы используют глубокие сверточные нейронные сети~\cite{DEEP}.
    \par Первые подходы к классификации пола использовали фотографии лица низкого разрешения - до 20 на 20 пикселей,
    и обучали на них различные типы классификаторов~\cite{smoll}.
    Позднее стали использовать LBP для выявления новых признаков~\cite{lbp_age},
    использовать сверточные нейронные сети~\cite{hassner,INDIA}.
    \par В ходе выполнения работы мы не будем предлагать каких-либо новых методов,
    однако мы воспользуемся рядом различных уже существующих технологий машинного обучения,
    проверив их качество при применении к нашей задаче.
    В итоге мы получим алгоритм, способный перебирать большие объемы фотографий,
    находить на них лица людей, а затем классифицировать их по полу и возрасту.
    \par Дальнейшая работа описана в следующих главах -
    Обзор литературы, Детектирование лиц, Классификация гендерных и возрастных групп, Выводы и Планы дальнейшей работы.
    "Детектирование лиц"\,выполнено Александром Шабалиным, "Классификация гендерных и возрастных групп"\,Алексеем Биршертом.
    \newpage


    \section{Обзор литературы}\label{sec:обзор-литературы}
    \input{literature}


    \section{Детектирование лиц}\label{sec:детектирование-лиц}
    \input{detection}
    \newpage


    \section{Классификация гендерных и возрастных групп}\label{sec:классификация-гендерных-и-возрастных-групп}
    \input{age_gender}
    \newpage


    \section{Выводы}\label{sec:выводы}
    Решая поставленную задачу о классификации людей на фотографиях по полу и возрасту мы получили алгоритм,
    позволяющий быстро - у нас была цель суметь обрабатывать миллион фотографий за день на одной видеокарте NVIDIA RTX 2080 Ti,
    и мы ее выполнили - и качественно находить лица людей на фотографиях, а затем классифицировать их пол и возраст.
    При решении мы опробовали множество различных подходов и остановились на архитектуре RetinaFace для детектирования лиц и двух ResNet для классификации пола и возраста соответственно.
    К сожалению, мы были ограничены вычислительными и временными ресурсами, поэтому не сумели добиться действительно высокого качества.
    \newpage


    \section{Планы дальнейшей работы}\label{sec:планы-дальнейшей-работы}
    Для улучшения качества классификации в дальнейшем у нас есть несколько идей, которые мы не успели реализовать.
    В своем решении для классификации пола и возраста мы используем только лицо.
    Безусловно, лицо содержит большую часть необходимых для классификации признаков, однако используя для классификации остальные части тела, можно добиться лучших результатов.
    Также мы не умеем детектировать и классифицировать людей со спины.
    Это довольно сложная задача, но ее решение внесло бы ощутимый вклад в работу нашего алгоритма.
    Кроме этого, в конечном варианте решения мы не отсекаем лица неживых людей, найденные детектирующей моделью.
    Мы пробовали отличать живые лица от фотографий и лиц на рекламных щитах с помощью LBP~\cite{lbp},
    но такой подход не дал ожидаемых результатов и мы отложили эту задачу из-за нехватки ресурсов на ее выполнение.
    Для классификации найденных лиц на памятники и живых людей мы пробовали два подхода:
    в первом мы пытались искать отличия на основе цветовой палитры, а во втором использовали сверточные нейронные сети.
    Первый метод не показал себя достаточно хорошо, второй не удалось довести до конца из-за нехватки данных для обучения и временных ресурсов.
    \newpage


    \section{Список литературы}\label{sec:список-литературы}
    \input{bibliography}

\end{document}